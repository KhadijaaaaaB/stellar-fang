
# Stellar Fang

## About The Project

Stellar Fang is a terminal-based game that simulates a high-stakes scenario aboard a spaceship (the Stellar Fang). The player assumes the role of the astronaut on the V.S.S. Stellar Fang after a critical system failure. The game is a race against time, challenging the player to diagnose and solve the problem using Bash commands in a simulated terminal before a catastrophic failure destroys the ship.

## Gameplay

### Objective

Your primary goal is to identify the damaged ship component, locate the necessary replacement parts, and execute the repair sequence to save the V.S.S. Stellar Fang. The mission is time-sensitive; failing to act quickly will result in the loss of the ship.

### How to Play


![Spaceship](spaceship.png)

The game unfolds through a series of logical steps requiring you to use terminal commands to navigate and interact with the ship's systems:

1. **Diagnosis:** Begin by exploring the ship's file system using `ls` and `cd`. 
4 critical systems have a `status.txt` file. Find and read them to find the one reporting a critical error. (see figure above for at-risk parts)
2. **Investigation:** The error message will tell you which components of the broken system need to be replaced. These components are located in the ship's `Storage`. You have to follow the EMERGENCY_REPAIR_GUIDE to repair the parts.
3. **The Puzzle:** Oh no... a virus is preventing you from repairing the spaceship (it's hiding repair_protocol.sh). The virus is running in the background. Identify it, then kill it! (use `ps` and `kill`) 
Once the virus is killed, the repair script should appear.
4. **Repair the ship:** You will find that the repair script, `repairprotocol.sh`, is locked due to file permissions. Unlock it.
5. **Resolution:** Execute the repair script (`./repairprotocol.sh`) to repair the ship and win the game.

### Outcomes

There are three possible outcomes based on your actions :

* **Mission SUCCESS:** You successfully repair the ship before the timer runs out.
* **Bail Out:** If you cannot fix the ship in time, you can find the Safety Hatches in the Orbiter, make `initiatebailout.sh` executable, and run it to save yourself while the ship is lost.
* **Mission FAILURE:** The timer expires before you can save the ship or yourself.


## Getting Started

To get a local copy up and running, follow these simple steps.

### Prerequisites

This game is designed to run in a Unix-like shell environment (like Linux or macOS) that supports Bash scripting.

### Installation

1. Clone the repo

```sh
git clone https://github.com/KhadijaaaaaB/stellar-fang.git
```

2. Navigate to the project directory

```sh
cd stellar-fang
```

3. Execute the main script to launch the game

```sh
./stellar_fang.sh
```


## Usage

Run the game by executing the main script. You can specify a difficulty level using the `--level` argument.

```sh
./stellarfang.sh --level [easy|hard]
```

* **Easy Mode:** 30-minute timer.
* **Normal Mode:** 20-minute timer. (default)
* **Hard Mode:** 10-minute timer.
The player can check the timer any time by typing `time` on the terminal.

To see a list of authorized commands and a brief explanation of the game's objective, type `help`.

## Project Structure

The project is organized into a modular structure for clarity and manageability :


| File | Description |
| :-- | :-- |
| `stellar_fang.sh` | The main game engine. It initializes the game, handles command-line arguments, manages the primary game loop, and processes user input. It also traps signals for win, loss, and bail-out conditions to end the game appropriately. |
| `setup.sh` | The world builder. This script runs at the start of the game to create the ship's directory structure, randomly select a damaged component, create status files and clues, and generate the bail-out and repair protocol scripts. It also launches the `ship_sync.sh` "virus" process.|
| `timer.sh` | Manages the countdown timer. It runs as a background process, and upon completion, sends a USR1 signal to the main script to trigger the "time up" sequence.|
| `cleanup.sh` | Resets the game environment. It kills any lingering background processes (like the timer) and removes all generated game files and directories, ensuring a clean state for the next playthrough.|
| `docs/help.txt` | A text file containing a list of allowed commands and a brief overview of the game's objective. |
| `ship_sync.sh` | Acts as a puzzle element (the "virus"). This lightweight script runs in the background, and the player must find and terminate its process to unlock the `repair_protocol.sh` script. |
| `repair_protocol.sh` | This script is generated by setup.sh after the player "kills" the virus. When executed, it runs check_parts.sh and, if successful, sends the USR2 (win) signal to the main game script. |
| `check_parts.sh` | A utility script called by repair_protocol.sh. It verifies that the player has moved the correct replacement parts into the forrepair directory before allowing the final repair to proceed. |

## All you need to know about this project
### Coding choices/strategies
To enhance game immersion, and feel truly like you've entered a game where you are in a specific environment, it was decided to implement this game in a simulated terminal created in the `stellar_fang.sh` script. 

At first, it was decided that only specific commands would be allowed (most of them are in `docs/help.txt`). This was done in the "case" block, where it would only allow specific commands and reject others.

I quickly came to the realization however that this was too limiting for the player. So I wanted to allow all bash commands. Which is why, by research, the "eval" command was found and used instead (`eval "$user_input" || true`).
To handle errors and impromptu game-exits, " || true " was used to ensure that the player doesn't quit the game in case of error in the command. The error will simply be displayed in the simulated terminal like it would be on the real one.

### Improvement
This project was made in a short period of time. Hence, many aspects of it need improvement to make it noob-proof. 
- First there needs to be a better management of cleanup of processes. About processes, if the player does not exit the game the regular way (by going in the game's main folder and typing exit), there might be some residue of old processes (for instance sleep 1200 which is the process responsible for the game's duration)
- A similar problem happens with files, which are not always correctly deleted when the player exits by closing the terminal or by doing Ctrl C.
- It would also be nice to manage a bit better the file system by putting all `.pid` files in a `pid` folder instead of in `docs`. That folder should be created whenever a `.pid` is created and deleted whenever the game is cleaned up.
- Bug with `repair_protocol.sh` : the file is set to appear when the fake-virus process `ship_sync.sh` is killed. If however the player does not kill the process, and exits the game or looses, the process `ship_sync.Sh` will be killed by `cleanup_sh` thus creating the `repair_protocol.sh` after the game is finished. This bug has not been fixed in its core, but the `repair_protocol.sh` file gets deleted in the case where it is created after the game ends (see last lines of `stellar_fang.sh`).

